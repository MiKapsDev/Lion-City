<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Lion City Experience Hub</title>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link
    href="https://fonts.googleapis.com/css2?family=Manrope:wght@400;500;600;700&family=Space+Grotesk:wght@500;600;700&display=swap"
    rel="stylesheet"
  />
  <link rel="stylesheet" href="assets/css/styles.css" />
  <link
    rel="stylesheet"
    href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
    integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
    crossorigin=""
  />
</head>
<body>
  <header class="site-header">
    <div class="container site-header__content">
      <a class="site-header__link" href="index.html" aria-label="Lion City Experience Hub home">
        <img class="site-header__logo" src="assets/img/lion-logo.png" alt="Lion City logo" />
      </a>
      <h1 class="site-header__title">Lion City Experience Hub</h1>
    </div>
  </header>
  <header class="hero">
    <div class="hero__content container">
      <p class="badge">Beta • QR Loyalty</p>
      <h2>Lion City Experience Hub</h2>
      <p class="subtitle">Scanne QR-Codes, sammle Punkte und löse sie in Shops oder Gruppen ein.</p>
      <div class="hero__actions">
        <button id="startScan" class="btn btn-primary btn-iconic">
          <svg class="btn-icon" viewBox="0 0 24 24" aria-hidden="true">
            <g transform="translate(-1.8,-0.6) scale(1.27,1.08)">
              <path d="M3 10.5a2 2 0 0 1 2-2h2.4l1-2h3.6l1 2H14a2 2 0 0 1 2 2V17a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V10.5z" fill="currentColor"/>
              <circle cx="9.5" cy="13.2" r="2.6" fill="currentColor"/>
            </g>
            <image href="assets/img/QR Symbol.png" x="8" y="1.0" width="14" height="14" preserveAspectRatio="xMidYMid meet"/>
          </svg>
          <span>Jetzt QR-Code scannen</span>
        </button>
      </div>
    </div>
  </header>

  <main class="container">
    <section id="scan" class="card">
      <div class="section-header">
        <h2>Cam Scan QR Codes</h2>
        <p>Aktiviere die Kamera, scanne Codes und erhalte automatisch Punkte.</p>
      </div>
      <div class="scan-grid">
        <div class="scan-preview">
          <div class="scan-frame">
            <video id="cameraPreview" autoplay playsinline muted></video>
            <canvas id="scanCanvas" aria-hidden="true"></canvas>
          </div>
          <p class="muted">Tippe auf "Scan starten" f&#252;r Kamera-Scan oder lade ein Foto hoch.</p>
        </div>
        <div class="scan-panel">
          <p class="label">Scan-Ergebnis</p>
          <p id="scanResult" class="scan-result">Noch kein Scan gestartet.</p>
          <p id="scanStatus" class="status-pill">Bereit</p>
          <button id="stopScan" class="btn btn-secondary btn-iconic">
            <svg class="btn-icon" viewBox="0 0 24 24" aria-hidden="true">
              <path d="M8 8h8v8H8zM4 6a2 2 0 0 1 2-2h3v2H6v3H4V6zm10-2h4a2 2 0 0 1 2 2v4h-2V6h-4V4zM6 18h3v2H6a2 2 0 0 1-2-2v-3h2v3zm12-3h2v3a2 2 0 0 1-2 2h-4v-2h4v-3z" fill="currentColor"/>
            </svg>
            <span>Scan stoppen</span>
          </button>
          <button id="uploadScan" class="btn btn-ghost btn-iconic">
            <svg class="btn-icon" viewBox="0 0 24 24" aria-hidden="true">
              <path d="M4 4h6v2H6v4H4V4zm10 0h6v6h-2V6h-4V4zM4 14h2v4h4v2H4v-6zm14 0h2v6h-6v-2h4v-4zM8 8h8v8H8V8zm2 2v4h4v-4h-4z" fill="currentColor"/>
            </svg>
            <span>QR-Bild hochladen</span>
          </button>
          <input id="uploadInput" type="file" accept="image/*" capture="environment" class="input-hidden" />
        </div>
      </div>
    </section>

    <section id="points" class="card">
      <div class="section-header">
        <h2>Deine Punkteübersicht</h2>
        <p>Verwalte dein Punktekonto, sammle Belohnungen und löse sie täglich ein.</p>
      </div>
      <div class="points-grid">
        <div class="points-balance">
          <p class="label">Aktueller Punktestand</p>
          <p id="pointsBalance" class="points-value">0</p>
          <p id="pointsMessage" class="status-pill">Bereit</p>
          <div class="transaction-panel">
            <p class="label">Transaktionen</p>
            <ul id="transactionList" class="transaction-list"></ul>
          </div>
          <button id="resetDemo" class="btn btn-reset" type="button" onclick="window.PointsManager?.resetDemo?.()">Demo zurücksetzen</button>
        </div>
        <div class="reward-shop">
          <p class="label">Tägliche Rewards</p>
          <ul id="rewardList" class="reward-list"></ul>
        </div>
      </div>
    </section>

    <section id="coupon-map" class="card">
      <div class="section-header">
        <h2>Coupon-Map Braunschweig</h2>
        <p>Karte mit (fiktiv) teilnehmenden Shops in Braunschweig.</p>
      </div>
      <div class="map-grid">
        <div id="couponMap" class="coupon-map" aria-label="Karte mit Coupon-Partnern"></div>
        <div class="map-panel">
          <p class="label">Teilnehmende Shops</p>
          <ul id="couponMapList" class="map-list"></ul>
        </div>
      </div>
    </section>

    <section id="groups" class="card">
      <div class="section-header">
        <h2>Gruppe erstellen</h2>
        <p>Starte eine Community, lade Mitglieder ein und teile eure Punkte-Erlebnisse.</p>
      </div>
      <form id="groupForm" class="form-grid" novalidate>
        <div class="form-control">
          <label for="groupName">Gruppenname</label>
          <input type="text" id="groupName" name="groupName" placeholder="z. B. Team Weekend" required />
          <small class="hint">Name erforderlich.</small>
        </div>
        <div class="form-control">
          <label for="groupMembers">Mitglieder-E-Mails (durch Komma getrennt)</label>
          <textarea id="groupMembers" name="groupMembers" rows="3" placeholder="mail@example.com, friend@example.com" required></textarea>
          <small class="hint">Mindestens eine gültige E-Mail-Adresse.</small>
        </div>
        <button type="submit" class="btn btn-primary">Gruppe speichern</button>
        <p id="groupStatus" class="status-pill">Noch keine Gruppe gespeichert.</p>
      </form>
      <div class="group-list">
        <h3>Gespeicherte Gruppen</h3>
        <p class="muted">Mitglieder lassen sich sp&#228;ter per E-Mail hinzuf&#252;gen.</p>
        <ul id="groupList"></ul>
      </div>
    </section>

    <section id="discounts" class="card">
      <div class="section-header">
        <h2>Gruppen-Discounts</h2>
        <p>Rabatte gibt es nur fuer Gruppen. Mindestgroesse ist 2 Mitglieder.</p>
      </div>
      <div id="discountContainer" class="discount-grid"></div>
    </section>
  </main>

  <footer class="footer">
    <div class="container footer__content">
      <p>Erstellt für eine schnelle QR-basierte Loyalty-Demo.</p>
      <p class="muted">Speicherung erfolgt lokal im Browser.</p>
    </div>
  </footer>

  <script src="https://cdn.jsdelivr.net/npm/jsqr@1.4.0/dist/jsQR.js"></script>
  <script
    src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
    integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
    crossorigin=""
  ></script>
  <script src="assets/js/points.js"></script>
  <script src="assets/js/discounts.js"></script>
  <script src="assets/js/groups.js"></script>
  <script src="assets/js/map.js"></script>
  <script src="assets/js/scan.js"></script>
</body>
</html>
